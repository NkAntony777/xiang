# 六十甲子象意百科查询系统（Phase 1）功能规格说明书

## 1. 项目概述

构建一个**六十甲子百科查询工具（Web版）**，提供六十甲子干支的基础信息检索、纳音五行查询、神煞标注、喜忌关系、象意展示以及干支之间的静态关系网络。该系统是后续扩展为完整八字命理系统的核心知识中台，要求数据准确、查询高效、界面清晰，支持移动端适配。

## 2. 系统角色

| 角色               | 描述                                                         |
| :----------------- | :----------------------------------------------------------- |
| **访客（未登录）** | 可浏览所有公开数据，使用查询功能，查看图谱，无法进行收藏、笔记等个性化操作。 |
| **注册用户**       | 在访客基础上增加收藏夹、个人笔记、历史记录等功能。           |
| **管理员**         | 管理后台，负责干支数据、纳音、神煞、象意、喜忌等知识条目的增删改查。 |

（Phase 1 可先实现访客+管理员，阶段一访客可以使用完整功能。注册用户功能可延后至Phase 2）

## 3. 功能模块详细描述

### 模块一：六十甲子辞典查询（核心）

#### 功能1.1 单柱干支快速查询

- **入口**：全局搜索框，支持输入天干+地支（如“甲子”）或仅地支（如“子”）模糊匹配。
- **输入**：用户输入字符串，系统自动补全候选干支。
- **输出**：跳转至该干支的详情页，展示以下所有结构化信息。

#### 功能1.2 干支详情页展示

详情页分为以下Tab或信息卡片区：

| 信息块       | 具体内容                                                     |
| :----------- | :----------------------------------------------------------- |
| **干支标识** | 天干、地支、阴阳、五行、方位、季节（月令）、原始名称（如阏逢、困敦） |
| **纳音信息** | 纳音名称、纳音五行、纳音状态（十二长生）、盛大/小弱分类、简要解释（如“海中金—宝物”） |
| **核心象意** | 列表展示，每条象意可附带简短解释（支持分页，管理员可维护）   |
| **细分象意** | 按类别折叠：天文气象、地理建筑、人物伦常、性情、身体、事物、植物、器物（数据来自第一阶段整理） |
| **组合象意** | 由天干+地支组合衍生出的典型意象（如甲子=第一+孩子→长子），带来源标注（原文/推理） |
| **自带神煞** | 列表展示，每个神煞带悬浮提示框显示定义（如进神、平头、悬针等） |
| **喜忌**     | 喜：五行、季节、地支；忌：五行、季节、地支（支持多选）       |
| **特殊性质** | 原文直接定性的描述，如“甲子—宝物”、“乙丑—顽矿”               |

#### 功能1.3 多柱对比

- **入口**：干支详情页内“加入对比”按钮，或导航栏“对比中心”。
- **操作**：用户可选择2～4组干支加入对比列表，系统并排展示上述所有信息字段的差异对比表格。
- **导出**：支持将对比结果导出为CSV/PDF。

------

### 模块二：纳音五行专题

#### 功能2.1 纳音查询

- **按干支查纳音**：输入干支 → 显示纳音名称、五行、状态、盛大/小弱分类。
- **按纳音查干支**：输入纳音名称（支持模糊搜索） → 列出所有属于该纳音的干支（如“海中金”→甲子、乙丑）。

#### 功能2.2 纳音推算演示

- **入口**：纳音详情页内“推算方法”标签。
- **功能**：用户任选一组干支（如戊戌），系统以**图文步骤**演示三种推算方法：
  1. **隔八生子法**（同位娶妻，隔八生子）
  2. **大衍数法**（49 - 太玄数和）÷5 余数取生
  3. **太玄数直接法**（取个位数对应河图数，水一火二木三金四土五，相生得纳音）
- **要求**：每个步骤显示计算公式、中间数值、最终结果。

#### 功能2.3 纳音状态详解

- **列表页**：按十二长生状态（长生、沐浴、冠带、临官、帝旺、衰、病、死、墓、绝、胎、养）分类，点击某状态显示所有该状态的干支及简要性格/运势含义。
- **详情**：每个状态附带古代典籍释义及现代解读（如“自败—多成多败，易半途而废”）。

#### 功能2.4 盛大/小弱分类

- **分类页**：展示“盛大者”与“小弱者”两个集合，每个集合下列出对应的纳音五行及干支。
- **说明**：附原文引用及简单解说。

------

### 模块三：神煞速查与解释

#### 功能3.1 神煞字典

- **列表页**：按神煞名称字母/拼音排序，展示所有Phase 1需覆盖的神煞（进神、交神、伏神、退神、九丑、福星、天德、官贵、德合、破禄马、截路空亡、十恶大败、平头、悬针、破字、曲脚、阙字、聋哑、杖刑、华盖、正印、禄库等）。
- **详情页**：神煞名称、查法（如“甲子见子为福星”）、自带干支列表、吉凶属性、原文摘录、现代解读。

#### 功能3.2 干支自带神煞标注

- 在干支详情页“自带神煞”区块，每条神煞名称后置“详情”链接，点击弹出浮层显示该神煞完整定义。

#### 功能3.3 字形神煞智能提示

- 根据干支字形，自动标注平头、悬针、破字、曲脚、阙字等（如甲、丙、丁、戊、庚、壬、辰为平头）。
- 在干支详情页用**标签**形式展示，鼠标悬浮时显示“此字形有平头象”。

------

### 模块四：干支关系图谱

#### 功能4.1 静态关系网络可视化

- **图谱入口**：全局导航“关系图谱”或干支详情页内“查看关系”。
- **图谱数据**：包含六十甲子所有节点，边类型包括：
  - 六合（子丑、寅亥等）
  - 三合（申子辰、亥卯未、寅午戌、巳酉丑）
  - 半三合（如巳酉、酉丑、巳丑等）
  - 六冲（子午、丑未等）
  - 六害（子未、丑午等）
  - 三刑（寅巳申、丑未戌、子卯、辰辰、午午、酉酉、亥亥等）
  - 自刑（辰、午、酉、亥）
  - 同位娶妻（甲子乙丑等）
  - 隔八生子（如甲子→壬申）
- **交互**：
  - 支持拖拽、缩放、节点悬停高亮显示关系标签。
  - 点击节点跳转至该干支详情页。
  - 支持按关系类型筛选显示边。
  - 支持导出当前视图为PNG。

#### 功能4.2 干支关系速查表

- **表格形式**：按地支列出与其有合、冲、刑、害的所有地支，简洁易读。
- **入口**：干支详情页“关系”标签下。

------

### 模块五：管理员后台

#### 功能5.1 知识条目管理

- **干支基础信息**：增删改查干支的五行、阴阳、方位、季节、原始名称等。
- **纳音信息**：维护纳音五行、状态、盛大/小弱分类。
- **象意管理**：为核心象意、细分象意、组合象意提供增删改查，支持批量导入（Excel/JSON）。
- **神煞管理**：维护神煞名称、查法、自带干支、吉凶、释义。
- **喜忌管理**：维护每柱干支的喜忌五行、季节、地支。
- **关系管理**：维护合冲刑害等关系数据（初期可一次性导入，后续通过界面调整）。

#### 功能5.2 数据导入导出

- **导入**：支持JSON/CSV格式批量导入干支、纳音、神煞、象意等基础数据。
- **导出**：将数据库所有数据导出为备份文件。

#### 功能5.3 用户与权限（Phase 1可简化）

- 仅实现管理员账号登录，不开放注册；或使用预设管理员账户。

------

## 4. 数据模型（核心实体）

| 实体             | 属性                                                         |
| :--------------- | :----------------------------------------------------------- |
| **干支**         | id, 天干, 地支, 阴阳, 天干五行, 地支五行, 方位, 季节, 天干原始名, 地支原始名, 特殊性质 |
| **纳音**         | id, 干支ID, 纳音名称, 纳音五行, 纳音状态, 盛大/小弱, 状态描述 |
| **象意**         | id, 干支ID, 象意类型(核心/细分/组合), 类别(天文/地理等), 象意文本, 解释, 来源(原文/推理), 置信度 |
| **神煞**         | id, 名称, 查法, 吉凶, 原文, 现代解读, 备注                   |
| **干支神煞关联** | id, 干支ID, 神煞ID, 是否自带                                 |
| **喜忌**         | id, 干支ID, 喜忌类型(喜/忌), 对象类型(五行/季节/地支), 对象值, 备注 |
| **干支关系**     | id, 干支1, 干支2, 关系类型(六合/三合/半合/六冲/六害/三刑/自刑/同位/隔八生子), 备注 |

------

## 5. 界面原型概要（文字描述）

### 5.1 首页

- 顶部导航：首页、干支查询、纳音专题、神煞字典、关系图谱、管理后台（仅管理员可见）。
- 中央大搜索框：输入干支或纳音，支持下拉补全。
- 热门干支推荐卡片：随机展示6个干支，点击进入详情。
- 快速入口：纳音分类、神煞分类、盛大/小弱分类。

### 5.2 干支详情页

- 左侧信息栏：干支名称、五行阴阳、方位季节等基础信息卡片。
- 右侧纳音卡片：纳音名称、状态、盛大/小弱标签，旁边附带“推算”按钮。
- 下方分页标签：
  - **象意**：核心象意、细分象意、组合象意分三列展示。
  - **神煞**：列表，每条带解释。
  - **喜忌**：两列（喜/忌）展示。
  - **关系**：合冲刑害速查表。
- 右上角“加入对比”按钮。

### 5.3 纳音专题页

- 左侧按纳音五行分类（金木水火土）导航。
- 右侧展示该五行下所有纳音名称，点击进入纳音详情页（展示纳音简介、干支列表、状态分布）。

### 5.4 神煞字典页

- 左侧按字母索引，右侧列表展示神煞名称及简短描述，点击进入详情。

### 5.5 关系图谱页

- 全屏画布，顶部工具栏：关系类型筛选、重置、下载PNG、搜索干支。
- 默认展示六十甲子全图（力导向图）。

------

## 6. 技术约束与建议

- **前端**：响应式设计，支持PC与移动端（至少1024px以下适配）。
- **后端**：提供RESTful API，返回JSON数据。
- **数据库**：sqlite，图谱关系可存储为邻接表，初期不强制使用图数据库。
- **性能**：干支详情页加载速度<1s，图谱页首次加载<3s。
- **部署**：支持Docker容器化，提供一键部署脚本。